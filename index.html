<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üîê Deepak's Secure Files</title>
<style>
body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    color: #333;
    transition: background 0.3s, color 0.3s;
}
body.dark-mode { background: #121212; color: #ddd; }

.container {
    background: #fff;
    border-radius: 15px;
    padding: 40px;
    width: 400px;
    max-width: 95%;
    text-align: center;
    box-shadow: 0 12px 30px rgba(0,0,0,0.3);
    animation: fadeIn 1s ease;
    position: relative;
}
body.dark-mode .container { background: #222; color: #ddd; }

@keyframes fadeIn { from { opacity:0; transform:translateY(-30px); } to { opacity:1; transform:translateY(0); } }

h1 { margin-bottom: 20px; font-size: 1.8rem; color: #4b2cc0; }
input { width:100%; padding:14px; margin:10px 0; border-radius:10px; font-size:1rem; border:1px solid #ddd; transition:border-color 0.3s; }
input:focus { border-color:#4b2cc0; outline:none; }
button { width:100%; padding:14px; background:#4b2cc0; color:white; border:none; border-radius:10px; font-size:1rem; cursor:pointer; transition:background 0.3s; margin-top:10px;}
button:hover { background:#341c87; }

.file-link { display:block; margin:12px 0; background:#2575fc; color:white; padding:14px; border-radius:10px; text-decoration:none; font-weight:bold; transition: background 0.3s; }
.file-link:hover { background:#0b47c2; }

.error { color:red; margin-top:10px; font-weight:bold; }
.toggle-password { cursor:pointer; position:absolute; right:30px; top:178px; font-size:1.2rem; color:#666; }
.logout-button { background:#e74c3c; margin-top:20px; }

@media(max-width:450px){.container{width:90%; padding:30px;}}

.info { font-size:0.9rem; color:#555; }
#adminHistory { margin-top:15px; text-align:left; max-height:150px; overflow-y:auto; border:1px solid #ddd; padding:10px; border-radius:8px; display:none; background:#f5f5f5; }
body.dark-mode #adminHistory { background:#333; color:#ddd; border-color:#555; }

/* Admin button on top-right */
#adminBtn {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 40px;
    height: 40px;
    font-size: 18px;
    border-radius: 50%;
    padding: 0;
}

/* Admin modal */
#adminModal {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.6);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}
#adminModal .modalContent {
    background: #fff;
    padding: 20px 30px;
    border-radius: 10px;
    max-width: 350px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}
#adminModal input { width:80%; margin:10px 0; }
#adminModal button { width:40%; margin:5px; }
</style>
</head>
<body>

<div id="customModal" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:#fff; padding:20px 30px; border-radius:10px; max-width:400px; text-align:center; box-shadow:0 8px 20px rgba(0,0,0,0.3);">
        <h2 style="color:#e74c3c;">‚è∞ Access Denied</h2>
        <p>Downloads are allowed only between <strong>4PM and 10PM</strong>.</p>
        <button style="padding:10px 20px; background:#4b2cc0; color:white; border:none; border-radius:8px; cursor:pointer;" onclick="closeModal()">OK</button>
    </div>
</div>

<div class="container" id="loginBox">
    <h1><i class="fa-solid fa-lock"></i> Login</h1>
    <input type="text" id="nameInput" placeholder="Enter your name" />
    <div style="position:relative;">
        <input type="password" id="passInput" placeholder="Enter password" />
        <span class="toggle-password" onclick="togglePassword()"></span>
    </div>
    <p>Solve: <span id="captchaQ"></span></p>
    <input type="number" id="captchaInput" placeholder="Enter CAPTCHA answer" />
    <button onclick="checkLogin()">Login</button>
    <p id="errorMsg" class="error"></p>
</div>

<div class="container" id="fileBox" style="display:none;">
    <h1><i class="fa-solid fa-file-lines"></i> Secure Downloads</h1>
    <p class="info" id="lastLogin"></p>

    <a href="#" class="file-link" onclick="return handleDownload('file1', 'https://drive.google.com/uc?export=download&id=1BdMiJJTMK18X1mVTA0yc4hisfhcZZ0_i')"><i class="fa-solid fa-download"></i> Download CAPCUT(DS) Folder </a>
    <p id="file1-count" class="info">Downloads: 0</p>
<a href="#" class="file-link" onclick="return handleDownload('file2', 'https://drive.google.com/uc?export=download&id=12aAnZHF1HiNfaewmtKAIABw12haKOefc')">
    <i class="fa-solid fa-download"></i> Download YT VIDEO
</a>
<p id="file2-count" class="info">Downloads: 0</p>

    <div id="adminHistory"></div>

    <button onclick="toggleDarkMode()"><i class="fa-solid fa-circle-half-stroke"></i> Toggle Dark Mode</button>
    <button class="logout-button" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>

    <!-- Small admin button top-right -->
    <button id="adminBtn" title="Admin Login" onclick="showAdminModal()"><i class="fa-solid fa-user-tie"></i></button>
</div>

<!-- Admin Modal -->
<div id="adminModal">
    <div class="modalContent">
        <h2>Admin Login</h2>
        <input type="password" id="adminPassInput" placeholder="Enter admin password" />
        <br>
        <button onclick="checkAdminPassword()">Login</button>
        <button onclick="closeAdminModal()">Cancel</button>
        <p id="adminError" style="color:red;"></p>
    </div>
</div>

<script>
let captchaAnswer;
let attempts = 0;

// CAPTCHA
function generateCaptcha(){
    const a=Math.floor(Math.random()*10)+1;
    const b=Math.floor(Math.random()*10)+1;
    captchaAnswer=a+b;
    document.getElementById('captchaQ').innerText=`${a} + ${b} = ?`;
}

// Normal Login
function checkLogin(){
    const name=document.getElementById('nameInput').value.trim();
    const password=document.getElementById('passInput').value.trim();
    const captchaInput=document.getElementById('captchaInput').value.trim();

    if(parseInt(captchaInput)!==captchaAnswer){ document.getElementById('errorMsg').innerText='‚ùå Incorrect CAPTCHA!'; return; }

    if(name==="Deepak Suthar" && password==="deepak95"){
        const now=new Date().toLocaleString();
        localStorage.setItem('loggedIn','true');
        localStorage.setItem('lastLogin',now);
        document.getElementById('lastLogin').innerText=`Last login: ${now}`;
        document.getElementById('loginBox').style.display='none';
        document.getElementById('fileBox').style.display='block';
        updateAdminHistory();
    }else{
        attempts++;
        document.getElementById('errorMsg').innerText='‚ùå Invalid Name or Password!';
        if(attempts>=3){
            alert('‚ö†Ô∏è Too many failed attempts! Try again later.');
            document.getElementById('nameInput').disabled=true;
            document.getElementById('passInput').disabled=true;
            document.getElementById('captchaInput').disabled=true;
            document.querySelector('button').disabled=true;
        }
    }
}

// Logout
function logout(){
    localStorage.removeItem('loggedIn');
    localStorage.removeItem('isAdmin');
    document.getElementById('nameInput').value='';
    document.getElementById('passInput').value='';
    document.getElementById('captchaInput').value='';
    document.getElementById('errorMsg').innerText='';
    document.getElementById('fileBox').style.display='none';
    document.getElementById('loginBox').style.display='block';
    generateCaptcha();
}

// Toggle password
function togglePassword(){
    const passInput=document.getElementById('passInput');
    passInput.type=passInput.type==='password'?'text':'password';
}

// Dark mode
function toggleDarkMode(){
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode',document.body.classList.contains('dark-mode'));
}

// Download handling
function handleDownload(id,url){
    const hour=new Date().getHours();
    if(hour<16||hour>22){ showModal(); return false; }
    incrementDownload(id);
    recordDownloadHistory(id);
    window.open(url,'_blank');
    return false;
}

// Access modal
function showModal(){ document.getElementById('customModal').style.display='flex'; }
function closeModal(){ document.getElementById('customModal').style.display='none'; }

// Increment downloads
function incrementDownload(id){
    let count=parseInt(localStorage.getItem(id)||'0');
    count++;
    localStorage.setItem(id,count);
    document.getElementById(`${id}-count`).innerText=`Downloads: ${count}`;
}

// Record history
function recordDownloadHistory(id){
    let history=JSON.parse(localStorage.getItem(`${id}-history`)||'[]');
    history.push({user:"Deepak Suthar",time:new Date().toLocaleString()});
    localStorage.setItem(`${id}-history`,JSON.stringify(history));
    updateAdminHistory();
}

// Update Admin History
function updateAdminHistory(){
    if(localStorage.getItem('isAdmin')!=='true') return;
    const container=document.getElementById('adminHistory');
    container.innerHTML='<strong>Download History (Admin Only):</strong><br>';
    ['file1','file2'].forEach(fileId=>{
        let history=JSON.parse(localStorage.getItem(`${fileId}-history`)||'[]');
        history.slice(-5).forEach(item=>{
            container.innerHTML+=`${fileId}: ${item.user} - ${item.time}<br>`;
        });
    });
    container.style.display='block';
}

// Admin Modal functions
function showAdminModal(){
    document.getElementById('adminModal').style.display='flex';
    document.getElementById('adminPassInput').value='';
    document.getElementById('adminError').innerText='';
}
function closeAdminModal(){ document.getElementById('adminModal').style.display='none'; }
function checkAdminPassword(){
    const pwd = document.getElementById('adminPassInput').value;
    if(pwd==='deepak33'){
        localStorage.setItem('isAdmin','true');
        updateAdminHistory();
        closeAdminModal();
        alert("‚úÖ Admin Access Granted");
    } else {
        document.getElementById('adminError').innerText="‚ùå Incorrect Password";
    }
}

window.onload=()=>{
    generateCaptcha();
    if(localStorage.getItem('loggedIn')==='true'){
        document.getElementById('loginBox').style.display='none';
        document.getElementById('fileBox').style.display='block';
        document.getElementById('lastLogin').innerText=`Last login: ${localStorage.getItem('lastLogin')}`;
        updateAdminHistory();
    }
    document.getElementById('file1-count').innerText=`Downloads: ${localStorage.getItem('file1')||0}`;
    document.getElementById('file2-count').innerText=`Downloads: ${localStorage.getItem('file2')||0}`;
    if(localStorage.getItem('darkMode')==='true'){ document.body.classList.add('dark-mode'); }
};
</script>
</body>
</html>
